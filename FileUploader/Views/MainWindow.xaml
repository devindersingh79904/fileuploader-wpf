<Window x:Class="FileUploader.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="File Uploader"
        Height="640" Width="1000"
        Loaded="Window_Loaded">

    <DockPanel>

        <!-- Top controls -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="10" VerticalAlignment="Center">
            <Button Content="Select Files" Command="{Binding SelectFilesCommand}" Margin="0,0,8,0"/>
            <Button Content="Start"  Command="{Binding StartUploadCommand}" Margin="0,0,8,0"/>
            <Button Content="Pause"  Command="{Binding PauseAllCommand}"  Margin="0,0,8,0"/>
            <Button Content="Resume" Command="{Binding ResumeAllCommand}" Margin="0,0,8,0"/>
           
            <TextBlock Text="  |  Session:" VerticalAlignment="Center" Margin="12,0,4,0"/>
            <TextBlock Text="{Binding SessionId, FallbackValue=—}" FontWeight="Bold" VerticalAlignment="Center"/>
        </StackPanel>

        <!-- Overall status/progress -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="10,0,10,10" VerticalAlignment="Center">
            <TextBlock Text="{Binding SessionStatus, FallbackValue=Ready}" />
            <TextBlock Text="  |  " />
            <TextBlock Text="{Binding OverallProgressText, FallbackValue=Overall: 0% (0 files)}" />
            <ProgressBar Minimum="0" Maximum="100" Height="16" Width="220" Margin="12,0,0,0"
                         Value="{Binding OverallProgress, FallbackValue=0}" />
        </StackPanel>

        <!-- Files table -->
        <DataGrid ItemsSource="{Binding Files}"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  IsReadOnly="True"
                  Margin="10"
                  EnableRowVirtualization="True"
                  HeadersVisibility="Column">
            <DataGrid.Columns>
                <DataGridTextColumn Header="#" Binding="{Binding Index, TargetNullValue=0}" Width="50" />

                <DataGridTextColumn Header="File Name"
                                    Binding="{Binding FileName, TargetNullValue=Unknown, FallbackValue=Unknown}"
                                    Width="200" />

                <DataGridTextColumn Header="Path"
                                    Binding="{Binding FullPath, TargetNullValue=—, FallbackValue=—}"
                                    Width="*" />

                <!-- Show raw bytes safely; no converter required -->
                <DataGridTextColumn Header="Size"
                                    Binding="{Binding SizeBytes, StringFormat={}{0:N0} B, TargetNullValue=0, FallbackValue=0}"
                                    Width="140" />

                <DataGridTextColumn Header="Status"
                                    Binding="{Binding Status, TargetNullValue=Ready, FallbackValue=Ready}"
                                    Width="130" />

                <!-- Progress as % text -->
                <DataGridTextColumn Header="Progress"
                                    Binding="{Binding Progress, StringFormat={}{0}%, TargetNullValue=0, FallbackValue=0}"
                                    Width="90" />

                <!-- Progress bar -->
                <DataGridTemplateColumn Header="Progress Bar" Width="160">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <ProgressBar Minimum="0" Maximum="100" Height="16"
                                         Value="{Binding Progress, TargetNullValue=0, FallbackValue=0}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

    </DockPanel>
</Window>
